# Voice Agent Configuration File
# All submodules use this file for configuration.

# Orchestrator Service Configuration
orchestrator:
  host: "0.0.0.0"
  port: 8000
  stt_websocket_path: "/ws/stt"
  log_level: "INFO"
  enable_latency_tracking: true

# STT (Speech-to-Text) Service Configuration
stt:
  host: "0.0.0.0"
  port: 8001
  model_size: "small"  # Options: tiny, base, small, medium, large, large-v2, large-v3
  language_code: "zh"  # Language code for transcription
  sample_rate: 16000
  interim_transcript_min_samples: 4800  # Minimum audio samples (0.3s at 16kHz) for interim transcription
  flush_command: "\x00"  # Special byte command to finalize transcription

# LLM (Language Model) Service Configuration
llm:
  host: "0.0.0.0"
  port: 8002
  provider: "gemini"  # Options: gemini, llamacpp
  providers:
    gemini:
      model: "gemini-2.5-flash"  # Model name
      api_key: ""  # Optional: Override GEMINI_API_KEY environment variable. Leave empty to use env var.
    llamacpp:
      model_path: "C:/Users/wdong/.cache/huggingface/hub/models--Qwen--Qwen3-8B-GGUF/snapshots/7c41481f57cb95916b40956ab2f0b139b296d974/Qwen3-8B-Q6_K.gguf"  # Path to GGUF model file
      n_ctx: 4096  # Context window size
      n_threads: 0  # Number of threads (0 = auto)
      n_gpu_layers: -1  # Number of layers to offload to GPU (-1 = all layers)

# TTS (Text-to-Speech) Service Configuration
tts:
  host: "0.0.0.0"
  port: 8003
  provider: "edge-tts"  # Options: edge-tts, chattts
  output_sample_rate: null  # When null, inherits audio.output_sample_rate
  providers:
    edge-tts:
      voice: "zh-CN-XiaoxiaoNeural"  # Voice name
      rate: "+0%"  # Speech rate (e.g., -50% for slower, +50% for faster)
      pitch: "+0Hz"  # Pitch adjustment
    chattts:
      model_source: "local"  # Options: local, huggingface, custom
      device: null  # Options: cuda, cpu, null (auto-detect)

# OCR (Optical Character Recognition) Service Configuration
ocr:
  host: "0.0.0.0"
  port: 8004
  language: "ch"  # Chinese and English support
  interval_ms: 1000  # Default monitoring interval in milliseconds
  texts_storage_file_prefix: "ocr_detected_texts"  # Prefix for text storage files

# Audio Driver Configuration
audio:
  sample_rate: 16000
  output_sample_rate: 16000  # Playback sample rate and TTS target (e.g., 48000)
  channels: 1
  dtype: "float32"
  block_size_ms: 100  # Determines VAD sensitivity
  flush_command: "\x00"  # Special byte command to finalize transcription
  input_device: null  # Set to device index or name, null for default
  output_device: 31  # Set to device index or name, null for default
  silence_threshold_ms: 500  # 500ms of silence triggers a flush
  vad_min_speech_prob: 0.5  # Minimum speech probability for VAD
  plot_window_seconds: 2  # Show last 2 seconds of audio in plot
  plot_update_interval_ms: 50  # Update plot every 50ms

# Service URLs (used by orchestrator to connect to other services)
services:
  stt_websocket_url: "ws://localhost:8001/ws/transcribe"
  llm_base_url: "http://localhost:8002"
  tts_websocket_url: "ws://localhost:8003/synthesize/stream"
  ocr_websocket_url: "ws://localhost:8004/monitor/stream"
  ocr_base_url: "http://localhost:8004"

